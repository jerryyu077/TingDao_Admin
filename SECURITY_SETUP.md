# TingDao Admin å®‰å…¨è®¾ç½®æŒ‡å—

## ğŸ”´ ç´§æ€¥ï¼šç«‹å³ä¿æŠ¤ä½ çš„ç®¡ç†åå°

å½“å‰çŠ¶æ€ï¼š**æ¼”ç¤ºæ¨¡å¼ï¼Œä»»ä½•äººéƒ½èƒ½ç™»å½•**

---

## æ–¹æ¡ˆ1: Cloudflare Access ä¿æŠ¤ï¼ˆæ¨èï¼Œ5åˆ†é’Ÿå®Œæˆï¼‰

### âœ… ä¼˜ç‚¹
- ä¸éœ€è¦ä¿®æ”¹ä»£ç 
- ç«‹å³ç”Ÿæ•ˆ
- ä¼ä¸šçº§å®‰å…¨
- æ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼ˆGoogleã€GitHubã€é‚®ç®±OTPï¼‰

### ğŸ“ è®¾ç½®æ­¥éª¤

#### 1. è¿›å…¥Cloudflare Zero Trust
```
è®¿é—®: https://one.dash.cloudflare.com/
é€‰æ‹©ä½ çš„è´¦å· â†’ Zero Trust â†’ Access â†’ Applications
```

#### 2. åˆ›å»ºæ–°åº”ç”¨ç¨‹åº
```
ç‚¹å‡» "Add an application" â†’ "Self-hosted"

åº”ç”¨åç§°: TingDao Admin
å­åŸŸå: tingdao-admin-1 (æˆ–ä½ çš„å®é™…åŸŸå)
åŸŸå: pages.dev (æˆ–ä½ çš„è‡ªå®šä¹‰åŸŸå)
è·¯å¾„: /*

ç‚¹å‡» Next
```

#### 3. æ·»åŠ è®¿é—®ç­–ç•¥
```
ç­–ç•¥åç§°: Admin Only
æ“ä½œ: Allow
è§„åˆ™: 
  - Include â†’ Emails â†’ è¾“å…¥ä½ çš„é‚®ç®±åœ°å€ï¼ˆå¦‚ï¼šlivingwater.99lamb@gmail.comï¼‰
  - æˆ–è€…é€‰æ‹© "One-time PIN" å‘é€éªŒè¯ç åˆ°é‚®ç®±

ç‚¹å‡» Next â†’ Add application
```

#### 4. å®Œæˆï¼
```
ç°åœ¨è®¿é—® https://1a11308b.tingdao-admin-1.pages.dev
ä¼šå…ˆè·³è½¬åˆ°Cloudflareç™»å½•é¡µé¢
éªŒè¯èº«ä»½åæ‰èƒ½è¿›å…¥ç®¡ç†åå°
```

### â±ï¸ è®¾ç½®æ—¶é—´: 5åˆ†é’Ÿ
### ğŸ’° è´¹ç”¨: å…è´¹ï¼ˆCloudflare Zero Trust å…è´¹è®¡åˆ’ï¼š50ç”¨æˆ·ï¼‰

---

## æ–¹æ¡ˆ2: å®ç°çœŸå®ç™»å½•ç³»ç»Ÿï¼ˆé•¿æœŸæ–¹æ¡ˆï¼‰

### éœ€è¦å®ç°çš„åŠŸèƒ½

#### 1. åç«¯APIè®¤è¯ç«¯ç‚¹
```javascript
POST /v1/auth/login
{
  "username": "admin",
  "password": "hashed_password"
}

è¿”å›:
{
  "success": true,
  "token": "jwt_token_here",
  "user": {
    "id": "admin-001",
    "username": "admin",
    "role": "admin"
  }
}
```

#### 2. JWT TokenéªŒè¯
- æ‰€æœ‰APIè¯·æ±‚éœ€è¦æºå¸¦token
- åœ¨Cloudflare Workerä¸­éªŒè¯token
- è¿‡æœŸè‡ªåŠ¨ç™»å‡º

#### 3. å¯†ç åŠ å¯†å­˜å‚¨
- ä½¿ç”¨bcryptæˆ–argon2åŠ å¯†
- å­˜å‚¨åœ¨Cloudflare D1æ•°æ®åº“

#### 4. ä¼šè¯ç®¡ç†
- Tokenè¿‡æœŸæ—¶é—´ï¼ˆå¦‚ï¼š24å°æ—¶ï¼‰
- åˆ·æ–°tokenæœºåˆ¶
- ç™»å‡ºæ¸…é™¤token

### â±ï¸ å¼€å‘æ—¶é—´: 1-2å¤©
### ğŸ’° è´¹ç”¨: å…è´¹ï¼ˆCloudflare Workerså…è´¹é¢åº¦ï¼‰

---

## æ–¹æ¡ˆ3: IPç™½åå•ï¼ˆä¸´æ—¶è¡¥å……æ–¹æ¡ˆï¼‰

### Cloudflareé¡µé¢è§„åˆ™

```
1. è¿›å…¥ Cloudflare Dashboard
2. é€‰æ‹©ä½ çš„åŸŸå â†’ Rules â†’ Page Rules
3. åˆ›å»ºæ–°è§„åˆ™:
   - URL: tingdao-admin-1.pages.dev/*
   - IP Access Rules: 
     - å…è®¸ä½ çš„IPåœ°å€
     - é˜»æ­¢å…¶ä»–æ‰€æœ‰IP
```

### âš ï¸ é™åˆ¶
- åªé€‚åˆå›ºå®šIP
- æ¢ç½‘ç»œå°±æ— æ³•è®¿é—®
- ä¸é€‚åˆç§»åŠ¨åŠå…¬

---

## ğŸ¯ æ¨èå®æ–½é¡ºåº

### ç¬¬ä¸€æ­¥ï¼šç«‹å³ï¼ˆä»Šå¤©ï¼‰
âœ… **å¯ç”¨Cloudflare Access**
- 5åˆ†é’Ÿå®Œæˆ
- ç«‹å³ä¿æŠ¤ç«™ç‚¹
- ä¸éœ€è¦æ”¹ä»£ç 

### ç¬¬äºŒæ­¥ï¼šæœ¬å‘¨å†…
âœ… **å®ç°çœŸå®ç™»å½•API**
- å¼€å‘åç«¯è®¤è¯
- JWT TokenéªŒè¯
- å¯†ç åŠ å¯†

### ç¬¬ä¸‰æ­¥ï¼šæŒç»­ä¼˜åŒ–
âœ… **å…¶ä»–å®‰å…¨æªæ–½**
- å¯ç”¨2FAï¼ˆåŒå› ç´ è®¤è¯ï¼‰
- æ·»åŠ å®¡è®¡æ—¥å¿—
- è®¾ç½®è®¿é—®è­¦æŠ¥

---

## ğŸ”’ å…¶ä»–å®‰å…¨æœ€ä½³å®è·µ

### 1. ä½¿ç”¨è‡ªå®šä¹‰åŸŸå
```
ä¸è¦ç”¨: 1a11308b.tingdao-admin-1.pages.dev
ä½¿ç”¨: admin.tingdao.com
```
- æ›´ä¸“ä¸š
- æ›´éš¾è¢«å‘ç°
- å¯ä»¥éšæ—¶æ›´æ¢åº•å±‚æœåŠ¡

### 2. å¯ç”¨HTTPSï¼ˆCloudflareè‡ªåŠ¨ï¼‰
- å·²å¯ç”¨ âœ…
- å¼ºåˆ¶HTTPSé‡å®šå‘

### 3. è®¾ç½®CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰
```
åœ¨ Cloudflare Pages è®¾ç½®ä¸­æ·»åŠ  Headers:
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' cdn.tailwindcss.com cdn.jsdelivr.net code.iconify.design; style-src 'self' 'unsafe-inline' cdn.jsdelivr.net;
```

### 4. å®šæœŸæ›´æ¢å¯†ç /Token
- æ¯30-90å¤©æ›´æ¢ä¸€æ¬¡
- ä½¿ç”¨å¼ºå¯†ç ï¼ˆ12+å­—ç¬¦ï¼Œå¤§å°å†™+æ•°å­—+ç¬¦å·ï¼‰

### 5. ç›‘æ§è®¿é—®æ—¥å¿—
```
Cloudflare Analytics â†’ Security â†’ Events
æŸ¥çœ‹å¼‚å¸¸è®¿é—®å°è¯•
```

---

## â“ å¸¸è§é—®é¢˜

### Q: Cloudflare Accessä¼šå½±å“æ€§èƒ½å—ï¼Ÿ
A: ä¸ä¼šï¼Œåªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶éªŒè¯ï¼Œä¹‹åä¼šç¼“å­˜cookieï¼ˆ24å°æ—¶ï¼‰

### Q: æˆ‘æœ‰å¤šä¸ªç®¡ç†å‘˜æ€ä¹ˆåŠï¼Ÿ
A: Cloudflare Accesså¯ä»¥æ·»åŠ å¤šä¸ªé‚®ç®±ï¼Œæˆ–ä½¿ç”¨Google Workspaceç»„

### Q: å¿˜è®°ç™»å½•é‚®ç®±æ€ä¹ˆåŠï¼Ÿ
A: åœ¨Cloudflare Dashboard â†’ Access â†’ Applicationsä¸­ä¿®æ”¹å…è®¸çš„é‚®ç®±åˆ—è¡¨

### Q: èƒ½ç”¨GitHubè´¦å·ç™»å½•å—ï¼Ÿ
A: å¯ä»¥ï¼Cloudflare Accessæ”¯æŒGitHubã€Googleã€Azure ADç­‰

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœè®¾ç½®è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æŸ¥çœ‹Cloudflareå®˜æ–¹æ–‡æ¡£: https://developers.cloudflare.com/cloudflare-one/applications/
2. è”ç³»æŠ€æœ¯æ”¯æŒ: livingwater.99lamb@gmail.com

---

**é‡è¦æé†’**: 
- ğŸ”´ è¯·ç«‹å³å¯ç”¨Cloudflare Accessä¿æŠ¤ä½ çš„ç®¡ç†åå°
- ğŸŸ¡ åœ¨å®ç°çœŸå®ç™»å½•ç³»ç»Ÿä¹‹å‰ï¼Œä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨
- ğŸŸ¢ å®šæœŸæ£€æŸ¥å®‰å…¨è®¾ç½®å’Œè®¿é—®æ—¥å¿—

